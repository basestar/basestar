{
  "types": {
    "Task": {
      "@merge": "../includes/CommonType.json",
      "properties": {
        "name": {
          "type": "string",
          "required": true
        },
        "owner": {
          "type": {
            "ref": "User"
          },
          "expression": "before != null ? before.owner : caller.user"
        },
        "project": {
          "type": {
            "ref": "Project"
          }
        }
      },
      "indexes": {
        "owner": {
          "partition": ["project.id"],
          "sort": ["created"]
        }
      },
      "permissions": {
        "create": {
          "inherit": ["project.createTask"]
        }
      }
    }
  }
}