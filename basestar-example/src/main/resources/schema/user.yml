
User:

  properties:
    email:
      type:
        string:
          pattern: email
        visibility:
          expression: this.id == caller.id
    owner:
      type: User
      expression: this.owner ?? caller


  links:
    teams:
      schema: TeamUser
      expression: user.id == this.id
    invites:
      schema: TeamInvite
      expression: user.id == this.id
    projects:
      schema: ProjectUser
      expression: user.id == this.id

  indexes:
    email:
      partition: email
      unique: true
      consistency: ATOMIC

  permissions:
    create:
      expression: after.id == caller.id
    update:
      expression: before.id == caller.id
